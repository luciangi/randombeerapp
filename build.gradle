plugins {
    id 'java'
    id 'org.springframework.boot' version '2.1.6.RELEASE'
    id 'io.spring.dependency-management' version '1.0.8.RELEASE'
    id 'io.franzbecker.gradle-lombok' version '3.1.0'
    id 'com.moowork.node' version '1.3.1'
}

group 'com'
version '1.0-SNAPSHOT'

sourceCompatibility = 1.8
targetCompatibility = 1.8

node {
    download = true
}

repositories {
    mavenCentral()
}

dependencies {
    compile(
            "org.springframework.boot:spring-boot-starter-web",
            "org.springframework.boot:spring-boot-starter-actuator",
            "org.springframework.boot:spring-boot-starter-data-jpa",
            "org.springframework.boot:spring-boot-starter-data-rest"
    )

    testCompile("org.springframework.boot:spring-boot-starter-test")

    runtime(
            "com.h2database:h2:1.4.199"
    )
}

task webpack(type: NpmTask, dependsOn: npm_install) {
    args = ["run", "prod"]
}

processResources.doFirst {
    tasks.webpack.execute()
}
